<!DOCTYPE html>
<html>
<head>
    <title>Capture Packets</title>
</head>
<body>
    <h2>Packet Capture</h2>
    <!-- <form method="post">
        Interface: <input name="interface" required><br>
        Packet Count: <input name="packet_count" type="number" value="10"><br>
        Filter: <input name="filter"><br>
        <button type="submit">Start Capture</button>
    </form> -->

        {% if error %}
        <p style="color: red;">Error: {{ error }}</p>
        {% endif %}


        <form method="post">
        <label for="interface">Interface:</label>
        <select name="interface" id="interface" required>
            <option value="" disabled selected>Select Interface</option>
            <option value="eth0">eth0</option>
            <option value="wlan0">wlan0</option>
            <option value="lo">lo</option>
            <option value="Wi-Fi">Wi-Fi</option>
            <!-- Add more interfaces here -->
        </select><br><br>

        <label for="packet_count">Packet Count:</label>
        <input name="packet_count" id="packet_count" type="number" value="10" min="1"><br><br>

        <label for="filter">Filter:</label>
        <select name="filter" id="filter">
            <option value="" selected>No Filter</option>
            <option value="src host 192.168.1.1">src host 192.168.1.1</option>
            <option value="dst host 192.168.1.1">dst host 192.168.1.1</option>
            <option value="tcp">TCP</option>
            <option value="udp">UDP</option>
            <option value="icmp">ICMP</option>
            <!-- Add more filters here -->
        </select><br><br>

        <button type="submit">Start Capture</button>
    </form>


    

    {% if packets %}
    <h2>Captured Packets:</h2>
    <table border="1">
        <tr>
            <th>Source IP</th>
            <th>Destination IP</th>
            <th>Protocol</th>
            <th>Source Port</th>
            <th>Destination Port</th>
            <th>Payload (first 100 chars)</th>
        </tr>
        {% for pkt in packets %}
        <tr>
            <td>{{ pkt['source_ip'] or 'N/A' }}</td>
            <td>{{ pkt['destination_ip'] or 'N/A' }}</td>
            <td>{{ pkt['protocol'] or 'N/A' }}</td>
            <td>{{ pkt['source_port'] or 'N/A' }}</td>
            <td>{{ pkt['destination_port'] or 'N/A' }}</td>
            <td>{{ pkt['payload_data'] or '' }}</td>

        </tr>
        {% endfor %}
    </table>
{% endif %}
</body>
</html>
